# FastAPI Users + AWS Lambda Example

Note: this example mostly leverages other tutorials to create a users database API with FastAPI Users and AWS Lambda. 

## 1. Create Users API 

App is configured following `FastAPI Users` instructions starting [here](https://frankie567.github.io/fastapi-users/installation/). The SQLAlchemy [full example](https://frankie567.github.io/fastapi-users/configuration/full_example/) was modified to create `app/lambda_function.py`

Next, create a file named `config.py` in the `app` directory:

`touch app/config.py`

Define the following variables as per your your needs:

```python
testing = False
SECRET = "SECRET"    
PROJECT_NAME = "My Users API"
STAGE_NAME = "/dev" # remember this so you set the correct stage name in AWS API settings later
DB_USERNAME = "username"
DB_PASSWORD = "password"
DB_ADDRESS = "1.1.1.1" #  db host name/address
DB_NAME = "db_name"
```

## 2. Create the API with AWS

Given the possible modifications below, follow instructions [here](https://towardsdatascience.com/fastapi-aws-robust-api-part-1-f67ae47390f9) to do so.

####  Modifications: 
- For the AWS lambda layer creation step (step 1), you can alternatively use the zip file created via `create_aws_layer` i.e. `fastapi-mysql.zip`:

`sh create_aws_layer`

This step loads all your python dependencies into one place. If your zip file is < 10 MB, you can forego the S3 step as well and upload the zip directly. 

- Only upload the contents of `app` to your root AWS lamnbda function directory.

- If you want to take advantage of `/docs` route, you must speicify the `openapi_prefix` in `lambda_function.py` which is tied to `STAGE_NAME` in `app/config.py`. See this [issue from fastapi-aws-lambda-example](https://github.com/iwpnd/fastapi-aws-lambda-example/issues/2) for more details. 

This example uses MySQL as the database but this repo can be easily adapated to use other backends (e.g. postgres, sqlite etc.) See [FastAPI Users Documentation](https://frankie567.github.io/fastapi-users/installation/) for more details. 





